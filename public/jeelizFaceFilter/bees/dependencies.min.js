/* jeelizFaceFilter/helpers/addDragEventListener.js */
const _states={idle:0,loading:1,dragging:2};let _state=_states.idle,_dP=new window.THREE.Vector3,_x0=-1,_y0=-1,_scenes=null,_boundFunction=null;function updateMeshPosition(e,t){const n=new window.THREE.Vector3,o=new window.THREE.Vector3,s=new window.THREE.Vector3;if(_state!==_states.dragging)return;const i=!(!t.touches||!t.touches.length),u=i?t.touches[0].clientX:t.clientX,c=i?t.touches[0].clientY:t.clientY,d=u-_x0,r=c-_y0;_x0=u,_y0=c;const a=-d/e.offsetWidth,E=-r/e.offsetHeight,m=1===_scenes.length?_scenes[0]:_scenes.find(function(t){if(!t.parent.visible)return!1;n.set(-u/e.offsetWidth*2+1,-c/e.offsetHeight*2+1,.5);const o=new window.THREE.Raycaster;return o.setFromCamera(n,window.THREECAMERA),o.intersectObjects(t.children).length>0});if(!m)return;if(s.set(a,E,1),o.copy(s),!window.THREECAMERA)throw new Error("Cannot find the THREE.js camera. Please check that window.THREECAMERA is the default scene camera");o.unproject(window.THREECAMERA),o.sub(window.THREECAMERA.position),o.normalize();const w=-1/o.z;_dP.copy(o).multiplyScalar(w),_dP.setZ(0);const l=new window.THREE.Quaternion,_=new window.THREE.Euler;_.setFromQuaternion(l),_dP.applyEuler(m.getWorldQuaternion(_)),_dP.multiplyScalar(10),m.position.add(_dP)}function setMousePosition0(e){const t=!(!e.touches||!e.touches.length);t&&e.touches.length>1||(_x0=t?e.touches[0].clientX:e.clientX,_y0=t?e.touches[0].clientY:e.clientY)}function mouseDown(e){setMousePosition0(e),_state=_states.dragging}function mouseUp(){_state=_states.idle}function addDragEventListener(e,t,n){_scenes=Array.isArray(e)?e:[e];const o=document.getElementById(void 0===t?"jeeFaceFilterCanvas":t);_state=_states.idle,_dP=new window.THREE.Vector3,_x0=void 0,_y0=void 0,n?(o.removeEventListener("mousemove",_boundFunction,!0),o.removeEventListener("touchmove",_boundFunction,!0),o.removeEventListener("mousedown",mouseDown),o.removeEventListener("touchstart",mouseDown),o.removeEventListener("mouseup",mouseUp),o.removeEventListener("touchend",mouseUp),o.removeEventListener("mouseout",mouseUp),o.removeEventListener("touchcancel",mouseUp)):(_boundFunction=updateMeshPosition.bind(this,o),o.addEventListener("mousemove",_boundFunction,!0),o.addEventListener("touchmove",_boundFunction,!0),o.addEventListener("mousedown",mouseDown),o.addEventListener("touchstart",mouseDown),o.addEventListener("mouseup",mouseUp),o.addEventListener("touchend",mouseUp),o.addEventListener("mouseout",mouseUp),o.addEventListener("touchcancel",mouseUp))}
